!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/dist",t(t.s=0)}([function(e,n,t){e.exports=t(1)},function(e,n,t){"use strict";t.r(n);var r={};t.r(r),t.d(r,"nextdoorPixel",(function(){return p})),t.d(r,"uuidv4",(function(){return v})),t.d(r,"buildPixelPayload",(function(){return h})),t.d(r,"getQueryParam",(function(){return m})),t.d(r,"writeCookie",(function(){return x})),t.d(r,"getCookie",(function(){return S})),t.d(r,"getNdclid",(function(){return P})),t.d(r,"writeToStorage",(function(){return O})),t.d(r,"handleTrack",(function(){return E})),t.d(r,"handleRestrictedDataUsage",(function(){return A})),t.d(r,"default",(function(){return N}));var o=["order_value","product_context","order_id"],i=["city","country","date_of_birth","external_id","email","first_name","gender","last_name","phone_number","state","street_address","zip_code"],a=function(){return(a=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)},u=function(e,n,t,r){return new(t||(t=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,u)}c((r=r.apply(e,n||[])).next())}))},c=function(e,n){var t,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},l=function(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,o,i=t.call(e),a=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return a},s=function(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},d=function(){for(var e=[],n=0;n<arguments.length;n++)e=e.concat(l(arguments[n]));return e},f="https://flask.nextdoor.com/pixel",p={};function v(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(e){return(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16)}))}function g(e,n){return void 0===n&&(n=!0),u(this,void 0,void 0,(function(){var t,r,o;return c(this,(function(i){switch(i.label){case 0:return e?(n&&(e=e.toLowerCase()),t=(new TextEncoder).encode(e),[4,window.crypto.subtle.digest("SHA-256",t)]):[2,""];case 1:return r=i.sent(),o=Array.from(new Uint8Array(r)),[2,o.map((function(e){return e.toString(16).padStart(2,"0")})).join("")]}}))}))}var h=function(e){return Object.entries(e).map((function(e){var n=l(e,2),t=n[0],r=n[1];return null==r?null:(r&&"object"==typeof r&&(r=JSON.stringify(r)),t+"="+encodeURIComponent(r))})).filter((function(e){return e})).join("&")},y=function(){return/Safari/i.test(window.navigator.userAgent)&&!/Chrome/i.test(window.navigator.userAgent)},m=function(e,n){for(var t=n.split("&"),r=0;r<t.length;r++){var o=t[r].split("=");if(o[0]===e)return o[1]}return null},w=function(e){!function(e){var n=document.createElement("img");n.src=e,n.alt="",n.style.display="none"}(f+"?"+e)},b=function(e,n){switch(n){case"POST":!function(e){var n=new XMLHttpRequest;n.open("POST",f),n.withCredentials=!0,n.onreadystatechange=function(){4===n.readyState&&204!==n.status&&window.console.warn("Request failed to "+f+".")},n.send(JSON.stringify(e))}(e);break;case"GET":w(e)}},_=function(e,n,t,l){return u(void 0,void 0,void 0,(function(){var s,d,h,m,w;return c(this,(function(_){switch(_.label){case 0:return h=(d=r).buildPixelPayload,m=[a({pid:e,vrs:"9.3",ev:n,evn:null==t?void 0:t.nickname,pl:p.pl,v:p.v,ndclid:p.ndclid,ndclid_src:p.ndclid_src||0,rf:p.rf,sem:p.sem,tm:p.sendPixelByGTM?"GTM":"Manual",iid:v(),pageid:(p.pageURL&&p.pageURL===window.location.href||(p.pageId=v(),p.pageURL=window.location.href),p.pageId),sessionid:(P="",y()&&localStorage&&(P=localStorage.getItem("ndp_session_id")),P||(S("ndp_session_id")?P=S("ndp_session_id"):(P=v(),O("ndp_session_id",P,window.location.hostname))),P)},t&&t.event_id&&{eid:t.event_id})],w={},[4,(x=l,u(void 0,void 0,Promise,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return e={},x?[4,Promise.all(Object.keys(x).map((function(n){return u(void 0,void 0,void 0,(function(){var t,r,a;return c(this,(function(u){switch(u.label){case 0:return o.includes(n)?(e[n]=x[n],[3,4]):[3,1];case 1:return i.includes(n)?(t=x[n].toString().toLowerCase(),{32:"MD5",40:"SHA-1",64:"SHA-256",128:"SHA-512"}[(c=t).length]&&/^[a-fA-F0-9]+$/.test(c)?(e[n]=t,[3,4]):[3,2]):[3,4];case 2:return r=e,a=n,[4,g(t)];case 3:r[a]=u.sent(),u.label=4;case 4:return[2]}var c}))}))})))]:[2,e];case 1:return n.sent(),[2,e]}}))})))];case 1:return s=h.apply(d,[a.apply(void 0,m.concat([(w.cd=_.sent(),w.tz=p.tz,w.sw=p.screenWidth||0,w.sh=p.screenHeight||0,w.dpr=p.screenDensity||1,w.gpuV=p.gpuVendor,w.gpuR=p.gpuRenderer,w.rdu=p.rdu,w.rduco=p.rduco,w.rdust=p.rdust,w)]))]),p.sendPixelByGTM?p.sendPixelByGTM(f+"?"+s):b(s,"GET"),[2]}var x,P}))}))},x=function(e,n,t,r,o){if(void 0===t&&(t=""),void 0===r&&(r="/"),void 0===o&&(o=!1),null!=n){var i=e+"="+n+";expires="+t+";path=/;domain="+r+";SameSite=Lax"+(!1===o?"":"; Secure");document.cookie=i}},S=function(e){try{return document.cookie.split("; ").find((function(n){return n.startsWith(e+"=")})).split("=")[1]}catch(e){return""}},P=function(e){var n;return(n=m("ndclid",location.search.substring(1)))||(n=m("ndclid",decodeURIComponent(location.href)))?(O("ndclid",n,window.location.hostname),{ndclid:n,ndclid_src:1}):(n=m("ndclid",document.referrer))?(O("ndclid",null!=n?n:"",window.location.hostname),{ndclid:n,ndclid_src:1}):e.sendPixelByGTM&&e.getCookieValues&&(n=l(e.getCookieValues("ndclid"),1)[0])||y()&&localStorage&&(n=localStorage.getItem("ndclid"))||(n=S("ndclid"))?{ndclid:n,ndclid_src:2}:{ndclid:"",ndclid_src:0}},O=function(e,n,t){if(n){var r=new Date;r.setMonth(r.getMonth()+1);var o=t.replace("www.","").split(".");if(1!==o.length){var i="."+o.slice(-2).join(".");x(e,n,r.toUTCString(),i,!0),!S(e)&&o.length>2&&(i="."+o.slice(-3).join("."),x(e,n,r.toUTCString(),i,!0)),y()&&localStorage&&localStorage.setItem(e,n)}else x(e,n,r.toUTCString(),window.location.hostname,!0)}};var R=function(e){p.rf=document.referrer,p.tz=Intl.DateTimeFormat().resolvedOptions().timeZone||"",p.screenHeight=window.screen.height,p.screenWidth=window.screen.width,p.screenDensity=window.devicePixelRatio;var n=function(){var e,n,t=localStorage.getItem("gpuInfo");if(t)try{return JSON.parse(t)}catch(e){}var r=document.createElement("canvas"),o=null;try{for(var i=s(["webgl2","webgl","experimental-webgl"]),a=i.next();!a.done;a=i.next()){var u=a.value;try{if(o=r.getContext(u))break}catch(e){}}}catch(n){e={error:n}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}if(!o)return null;var c="N/A",l="N/A",d=o.getExtension("WEBGL_debug_renderer_info");try{d?(c=o.getParameter(d.UNMASKED_VENDOR_WEBGL)||"N/A",l=o.getParameter(d.UNMASKED_RENDERER_WEBGL)||"N/A"):(c=o.getParameter(o.VENDOR)||"N/A",l=o.getParameter(o.RENDERER)||"N/A")}catch(e){}var f={vendor:c,renderer:l};return localStorage.setItem("gpuInfo",JSON.stringify(f)),f}();n?(p.gpuVendor=n.vendor,p.gpuRenderer=n.renderer):(p.gpuVendor="",p.gpuRenderer=""),"user_email_hash"in e?p.sem=e.user_email_hash:"user_email"in e&&(p.em=e.user_email),Object.assign(p,P(p))},E=function(e,n,t){return u(void 0,void 0,void 0,(function(){var r,o,i,a;return c(this,(function(u){switch(u.label){case 0:return"string"!=typeof e?[2]:(p.pl=location.href,crypto.subtle&&p.em&&!p.sem?(r=p,[4,g(p.em)]):[3,2]);case 1:r.sem=u.sent(),u.label=2;case 2:if(!e)return[3,6];o=p.pixelIdList,Array.isArray(null==n?void 0:n.pixel_ids)&&(o=n.pixel_ids).forEach((function(e){-1===p.pixelIdList.indexOf(e)&&p.pixelIdList.push(e)})),i=0,u.label=3;case 3:return i<o.length?(a=o[i],[4,_(a,e,n,t)]):[3,6];case 4:u.sent(),u.label=5;case 5:return i++,[3,3];case 6:return[2]}}))}))},A=function(e,n){p.rdu=1,"number"==typeof e&&(p.rduco=e,"number"==typeof n&&(p.rdust=n))},T=function(e){for(var n=l(e),t=n[0],r=n.slice(1);r.length<3;)r.push({});switch(t.toLowerCase()){case"init":var o=l(r,2);return function(e,n){-1===p.pixelIdList.indexOf(e)&&p.pixelIdList.push(e),R(n)}(o[0],o[1]);case"restricteddatausage":var i=l(r,2),a=i[0],u=i[1];return A(a,u);case"track":var c=l(r,3),s=c[0],d=c[1],f=c[2];return E(s,d,f);default:console.error("Nextdoor pixel: library function "+t+" does not exist.")}},j=function(){if(p.queue&&p.queue.length){var e=d(p.queue.shift());T(e),p.processQueue()}},I=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];p.queue.push(e),p.processQueue()},N=function(e,n){return(p=e.ndp).v=e.ndp.v,p.pixelIdList=[],p.processQueue=j,p.handleRequest=I,{processQueue:p.processQueue}};try{N(window,document).processQueue()}catch(e){console.log(e),console.log("Problem with request")}}]);